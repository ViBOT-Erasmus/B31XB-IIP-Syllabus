%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%% LE2I beamer template
%% Guillaume Lemaitre, October 2014
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

\mode<presentation>

% Set the font environment for the header which is the smoothbars environment
\setbeamerfont{section in head/foot}{size=\tiny, shape=\scshape}

% Insert the information about the smoothbars environment
\beamer@compresstrue

\AtBeginDocument{
  {
    \usebeamerfont*{headline}
    \colorlet{global.bg}{bg}
    \usebeamercolor{section in head/foot}
    \usebeamercolor{frametitle}
    \pgfdeclareverticalshading{beamer@barshade}{\the\paperwidth}{%
      color(0ex)=(global.bg);%
      color(1ex)=(section in head/foot.bg);%
      color(7ex)=(section in head/foot.bg)%
    }
    \pgfdeclareverticalshading{beamer@aboveframetitle}{\the\paperwidth}{%
      color(0ex)=(frametitle.bg);%
      color(1ex)=(frametitle.bg);%
      color(2ex)=(section in head/foot.bg)
    }
    
    \pgfdeclareverticalshading{beamer@belowframetitle}{\the\paperwidth}{%
      color(0ex)=(global.bg);%
      color(1ex)=(frametitle.bg)
    }
  }
}

% Define the headline at the top of the presentation
\defbeamertemplate*{headline}{smoothbars theme}
{
  % This is here to avoid the outline in the table of content and the title page
  \ifnum \insertpagenumber<3
  % Otherwise, we have to show the outline
  \else
  \vskip4.5ex
  \begin{beamercolorbox}[ignorebg,ht=2.25ex,dp=3.75ex]{section in head/foot}
    \begin{tikzpicture}
      \useasboundingbox (0,.8) rectangle(\the\paperwidth,1.4);
      % Insert the navigation var
      {\node[anchor=west, nicewhite] at (0.2, 0.8){\insertnavigation{.8\paperwidth}};}
      % Insert the logo of the Universite de Bourgogne
      {\node[anchor=west, nicewhite] at (10.8, 0.9){\includegraphics[width=1.2cm]{\logoubnobg}};}
    \end{tikzpicture}
  \end{beamercolorbox}
  \fi
}


\defbeamertemplate*{frametitle}{smoothbars theme}
{%
  \vskip2.5ex
  \usebeamerfont{headline}%
  \vskip1.5ex%
  \definecolor{imred}{HTML}{BD2026}
  \definecolor{imyellowOB}{HTML}{FCED27}
  \definecolor{imorange}{HTML}{F6B419}
  \begin{beamercolorbox}[wd=\paperwidth,ht=1.9cm]{frametitle}
    \begin{tikzpicture}
      \useasboundingbox (0,0) rectangle(\the\paperwidth,1.4);
      {\node[anchor=west, nicewhite] at (0.4, 0.85){\includegraphics[width=1.2cm]{\logoimate}};}
      % {\node[anchor=west, nicewhite] at (10.8, 0.8){\includegraphics[width=1.2cm]{\logoubnobg}};}
      \fill[azulunam](2.2, 0.3) rectangle(.95\paperwidth,1.4);
      \ifx\insertframesubtitle\@empty%
      {\node[anchor=west, nicewhite, font=\large] at (3.0,0.82){\insertframetitle};}
      \else%
      {\node[anchor=west, nicewhite, font=\large] at (3.0, 1.02){\insertframetitle};%
        \node[anchor=west, nicewhite, font=\small] at (3.0, 0.63){\insertframesubtitle};}%        
      \fi
    \end{tikzpicture}
  \end{beamercolorbox}
  \vskip-5ex
}

\mode<all>
